<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="public/favicon/favicon.ico" sizes="any" type="image/x-icon" />
    <link rel="apple-touch-icon" href="public/favicon/apple-touch-icon.png" sizes="180x180" />
    <link rel="manifest" href="public/favicon/site.webmanifest" />
    <meta name="apple-mobile-web-app-title" content="YamkaTV" />
    <meta name="theme-color" content="#242424" />
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>

    <script>
      window.ym = window.ym || function () {
        (window.ym.a = window.ym.a || []).push(arguments);
      };
      window.ym.l = Date.now();

      function loadYandexMetrika() {
        if (document.getElementById('ym-script')) return;
        const script = document.createElement('script');
        script.id = 'ym-script';
        script.src = 'https://mc.yandex.ru/metrika/tag.js';
        script.async = true;
        script.onload = () => {
          window.ym(101420919, "init", {
            clickmap: true,
            trackLinks: true,
            accurateTrackBounce: true,
            webvisor: false
          });
        };
        script.onerror = () => {
          console.warn('Yandex Metrika blocked or failed to load.');
        };
        document.head.appendChild(script);
      }

      if ('requestIdleCallback' in window) {
        requestIdleCallback(loadYandexMetrika, { timeout: 3000 });
      } else {
        setTimeout(loadYandexMetrika, 3000);
      }
    </script>
    <noscript>
      <div>
        <img src="https://mc.yandex.ru/watch/101420919" style="position:absolute; left:-9999px;" alt="" />
      </div>
    </noscript>
  </body>
</html>
